/*Plugin by: Ara Abcarians: http://ara-abcarians.com License: http://creativecommons.org/licenses/by/3.0/ */
/*(function($){$.fn.aToolTip=function(options){var defaults={closeTipBtn:'aToolTipCloseBtn',toolTipId:'aToolTip',fixed:false,clickIt:true,inSpeed:200,outSpeed:100,tipContent:'',toolTipClass:'defaultTheme',xOffset:5,yOffset:5,onShow:null,onHide:null},settings=$.extend({},defaults,options);return this.each(function(){var obj=$(this);if(obj.attr('title')){var tipContent=obj.attr('title');}else{var tipContent=settings.tipContent;}
var buildaToolTip=function(){$('body').append("<div id='"+settings.toolTipId+"' class='"+settings.toolTipClass+"'><em>&nbsp;</em><p class='aToolTipContent'>"+tipContent+"</p></div>");if(tipContent&&settings.clickIt){$('#'+settings.toolTipId+' p.aToolTipContent').append("<a id='"+settings.closeTipBtn+"' href='#' alt=''></a>");}},positionaToolTip=function(){$('#'+settings.toolTipId).css({top:(obj.offset().top-$('#'+settings.toolTipId).outerHeight()-settings.yOffset)+'px',left:(obj.offset().left+obj.outerWidth()+settings.xOffset)+'px'}).stop().fadeIn(settings.inSpeed,function(){if($.isFunction(settings.onShow)){settings.onShow(obj);}});},removeaToolTip=function(){$('#'+settings.toolTipId).stop().fadeOut(settings.outSpeed,function(){$(this).remove();if($.isFunction(settings.onHide)){settings.onHide(obj);}});};if(tipContent&&!settings.clickIt){obj.hover(function(){$('#'+settings.toolTipId).remove();obj.attr({title:''});buildaToolTip();positionaToolTip();},function(){removeaToolTip();});}
if(tipContent&&settings.clickIt){obj.click(function(el){$('#'+settings.toolTipId).remove();obj.attr({title:''});buildaToolTip();positionaToolTip();$('#'+settings.closeTipBtn).click(function(){removeaToolTip();return false;});return false;});}
if(!settings.fixed&&!settings.clickIt){obj.mousemove(function(el){$('#'+settings.toolTipId).css({top:(el.pageY-$('#'+settings.toolTipId).outerHeight()-settings.yOffset),left:(el.pageX+settings.xOffset)});});}});};})(jQuery);
*/

(function($){
	$.fn.aToolTip=function(options){
		var defaults={
			closeTipBtn:'aToolTipCloseBtnFixed',
			toolTipId:'aToolTipFixed',
			fixed:false,
			clickIt:true,
			inSpeed:200,
			outSpeed:100,
			tipContent:'',
			toolTipClass:'defaultTheme',
			xOffset:5,
			yOffset:5,
			onShow:null,
			onHide:null
		},
		settings=$.extend({},
		defaults,
		options);return this.each(function(){
			var obj=$(this);if(obj.data('tooltip')){
				var tipContent=obj.data('tooltip');
			}else{
				var tipContent=settings.tipContent;
			}var buildaToolTip=function(){
				$('body').append("<div id='"+settings.toolTipId+"' class='"+settings.toolTipClass+"'><em>&nbsp;</em><p class='aToolTipContent'>"+tipContent+"</p></div>");if(tipContent&&settings.clickIt){
					$('#'+settings.toolTipId+' p.aToolTipContent').append("<a id='"+settings.closeTipBtn+"' href='#' alt=''></a>");
				}
			},
			positionaToolTip=function(){
				$('#'+settings.toolTipId).css({
					top:(obj.offset().top-$('#'+settings.toolTipId).outerHeight()-settings.yOffset)+'px',
					left:(obj.offset().left+obj.outerWidth()+settings.xOffset)+'px'
				}).stop().fadeIn(settings.inSpeed,
				function(){
					if($.isFunction(settings.onShow)){
						settings.onShow(obj);
					}
				});
			},
			removeaToolTip=function(){
				$('.map .auto-bg').css('background-image', '')
				$('#'+settings.toolTipId).stop().fadeOut(settings.outSpeed,
				function(){
					$(this).remove();if($.isFunction(settings.onHide)){
						settings.onHide(obj);
					}
				});
			};if(tipContent&&!settings.clickIt){
				obj.hover(function(){
					$('#'+settings.toolTipId).remove();obj.attr({
						title:''
					});buildaToolTip();positionaToolTip();
				},
				function(){
					removeaToolTip();
				});
			}if(tipContent&&settings.clickIt){
				obj.click(function(el){
					$('#'+settings.toolTipId).remove();obj.attr({
						title:''
					});buildaToolTip();positionaToolTip();$('#'+settings.closeTipBtn).click(function(){
						removeaToolTip();return false;
					});return false;
				});
			}if(!settings.fixed&&!settings.clickIt){
				obj.mousemove(function(el){
					$('#'+settings.toolTipId).css({
						top:(el.pageY-$('#'+settings.toolTipId).outerHeight()-settings.yOffset),
						left:(el.pageX+settings.xOffset)
					});
				});
			}
		});
	};
})(jQuery);


$(function() {
	$('#map--regional_offices area').hover(function(e){
		if ($(this).data('tooltip')) {
			if ($(this).parent()[0].nodeName.toLowerCase() != 'span') {
				$(this).wrap('<span />');
			}
			var parent = $(this).parent();
			$(parent).attr('data-tooltip', $(this).data('tooltip'));
			var coords = $(this).attr('coords').split(',');
			var coordx = new Array();
			var coordy = new Array();
			var k=0;
			for (var i = 0; i < coords.length; i+=2)
			{
				coordx[k] = parseInt(coords[i]);
				coordy[k] = parseInt(coords[i+1]);
				k++;
			}
			var maxx = Math.max.apply(0, coordx);
			var minx = Math.min.apply(0, coordx);
			var maxy = Math.max.apply(0, coordy);
			var miny = Math.min.apply(0, coordy);

			// var mapx = $(this).parent().offset().left;
			// var mapy = $(this).parent().offset().top;
			
			var dotx = (maxx + minx) / 2 - 150;
			var doty = miny + (maxy - miny) / 3;
			//doty = doty - 330
			var browser = $.browser;
			if (browser.mozilla){
				doty = doty - 370
			}
			// console.log(maxy + ":" + miny + " :: " + doty);
			parent.aToolTip({toolTipClass: 'defaultTheme2', xOffset:dotx, yOffset:-doty, clickIt: true});
		};
	});




});

